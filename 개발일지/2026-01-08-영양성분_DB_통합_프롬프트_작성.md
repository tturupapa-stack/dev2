# ì˜ì–‘ì„±ë¶„ DB í†µí•© í”„ë¡¬í”„íŠ¸ ì‘ì„± ê°œë°œì¼ì§€

**ì‘ì„±ì¼**: 2026-01-08
**ì‘ì„±ì**: Claude (AI Assistant)
**ì‘ì—… ë‚´ìš©**: ì‹í’ˆì˜ì•½í’ˆì•ˆì „ì²˜ ì˜ì–‘ì„±ë¶„ DBë¥¼ logic_designer ëª¨ë“ˆì— í†µí•©í•˜ê¸° ìœ„í•œ í”„ë¡¬í”„íŠ¸ ë¬¸ì„œ ì‘ì„±

---

## ğŸ“‹ ì‘ì—… ê°œìš”

ì˜¤ëŠ˜ ì§„í–‰í•œ ì£¼ìš” ì‘ì—…:
1. ì˜ì–‘ì„±ë¶„ DB í†µí•©ì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ ë¬¸ì„œ ì‘ì„± (5ê°œ íŒŒì¼)
2. ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬ ê°€ì´ë“œ ì‘ì„±
3. ëª¨ë“  í”„ë¡¬í”„íŠ¸ì— ì˜¤ë¥˜ ì²˜ë¦¬ ë° ë¦¬ë·° ë¶€ì¡± ì‹œ ëŒ€ì²˜ ë°©ì•ˆ ì¶”ê°€
4. README ì—…ë°ì´íŠ¸

---

## 1ë‹¨ê³„: ì˜ì–‘ì„±ë¶„ DB í†µí•© í”„ë¡¬í”„íŠ¸ ì‘ì„±

### ì‘ì—… ë°°ê²½
- GitHubì— ì‹í’ˆì˜ì•½í’ˆì•ˆì „ì²˜ ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ ì˜ì–‘ì„±ë¶„ DB êµ¬ì¶• ì™„ë£Œ
- logic_designer ëª¨ë“ˆì˜ ê° íŒŒì¼ì— ì˜ì–‘ì„±ë¶„ ì •ë³´ë¥¼ í™œìš©í•˜ì—¬ ì‹ ë¢°ë„ í–¥ìƒ í•„ìš”
- ê° íŒŒì¼ë³„ ë§ì¶¤í˜• í†µí•© ë°©ì•ˆ ì œì‹œ í•„ìš”

### ìƒì„±ëœ í”„ë¡¬í”„íŠ¸ íŒŒì¼

#### 1. checklist_nutrition_integration.md
**ëŒ€ìƒ íŒŒì¼**: `logic_designer/checklist.py`

**ì£¼ìš” ë‚´ìš©**:
- ì›ë£Œ íŠ¹ì§• ë‚˜ì—´ ê²€ì¦ ê°•í™” (5ë²ˆ í•­ëª©): í—ˆìœ„ ì„±ë¶„ ì£¼ì¥ ê°ì§€
- ì „ë¬¸ ìš©ì–´ ì˜¤ë‚¨ìš© ê²€ì¦ (9ë²ˆ í•­ëª©): í—ˆìœ„ ì˜í•™ì  ì£¼ì¥ ê°ì§€
- ë¹„í˜„ì‹¤ì  íš¨ê³¼ ê°•ì¡° ê²€ì¦ (10ë²ˆ í•­ëª©): íš¨ê³¼ ì‹œì  ê²€ì¦
- ì œí’ˆë³„ ì²´í¬ ê¸°ì¤€ ê°•í™”

**í•µì‹¬ ê¸°ëŠ¥**:
- `_validate_ingredient_claims()`: í—ˆìœ„ ì„±ë¶„ ì£¼ì¥ ê²€ì¦
- `_validate_medical_claims()`: í—ˆìœ„ ì˜í•™ì  ì£¼ì¥ ê²€ì¦
- `_validate_effect_timeline()`: íš¨ê³¼ ì‹œì  ê²€ì¦
- `_get_nutrition_info_safe()`: ì•ˆì „í•œ ì˜ì–‘ì„±ë¶„ ì •ë³´ ì¡°íšŒ

#### 2. analyzer_nutrition_integration.md
**ëŒ€ìƒ íŒŒì¼**: `logic_designer/analyzer.py`

**ì£¼ìš” ë‚´ìš©**:
- AI í”„ë¡¬í”„íŠ¸ì— ì˜ì–‘ì„±ë¶„ ì •ë³´ ì£¼ì…
- ê°•í™”ëœ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ (ì˜ì–‘ì„±ë¶„ ì •ë³´ ê¸°ë°˜ ë¶„ì„)
- ì„±ë¶„ ê²€ì¦ ê²°ê³¼ë¥¼ ë¶„ì„ ê²°ê³¼ì— í¬í•¨
- í—ˆìœ„ ì£¼ì¥ ìë™ ê°ì§€ ë° ê²½ê³ 

**í•µì‹¬ ê¸°ëŠ¥**:
- `_build_enhanced_prompt()`: ì˜ì–‘ì„±ë¶„ ì •ë³´ í¬í•¨ í”„ë¡¬í”„íŠ¸ ìƒì„±
- `_format_nutrition_info()`: ì˜ì–‘ì„±ë¶„ ì •ë³´ í¬ë§·íŒ…
- `analyze_safe()`: ì•ˆì „í•œ ë¶„ì„ (ì˜¤ë¥˜ ì²˜ë¦¬ í¬í•¨)

#### 3. trust_score_nutrition_integration.md
**ëŒ€ìƒ íŒŒì¼**: `logic_designer/trust_score.py`

**ì£¼ìš” ë‚´ìš©**:
- ì˜ì–‘ì„±ë¶„ ì¼ì¹˜ë„ ì ìˆ˜ ì¶”ê°€
- ì‹ ë¢°ë„ ì ìˆ˜ ê³µì‹ í™•ì¥: `S = (LÃ—0.15) + (RÃ—0.15) + (MÃ—0.25) + (PÃ—0.1) + (CÃ—0.15) + (NÃ—0.2)`
- ì„±ë¶„ëª… ì¶”ì¶œ ë° ë§¤ì¹­ ë¡œì§
- ì„ íƒì  ì˜ì–‘ì„±ë¶„ ì ìˆ˜ ì ìš©

**í•µì‹¬ ê¸°ëŠ¥**:
- `calculate_nutrition_consistency_score()`: ì˜ì–‘ì„±ë¶„ ì¼ì¹˜ë„ ì ìˆ˜ ê³„ì‚°
- `_extract_ingredients()`: ë¦¬ë·°ì—ì„œ ì„±ë¶„ëª… ì¶”ì¶œ
- `_is_valid_ingredient()`: ì„±ë¶„ëª… ë§¤ì¹­ ê²€ì¦

#### 4. validator_nutrition_integration.md
**ëŒ€ìƒ íŒŒì¼**: `logic_designer/validator.py`

**ì£¼ìš” ë‚´ìš©**:
- ì˜ì–‘ì„±ë¶„ ê¸°ë°˜ ê²€ì¦ ê°•í™”
- ì˜ì–‘ì„±ë¶„ ì£¼ì¥ ê²€ì¦ í•¨ìˆ˜
- íš¨ëŠ¥ ì£¼ì¥ ê²€ì¦
- `check_ad_patterns()` í™•ì¥

**í•µì‹¬ ê¸°ëŠ¥**:
- `_validate_nutrition_claims()`: ì˜ì–‘ì„±ë¶„ ì£¼ì¥ ê²€ì¦
- `_validate_efficacy_claims()`: íš¨ëŠ¥ ì£¼ì¥ ê²€ì¦
- `validate_review()`ì— `product_id` ë§¤ê°œë³€ìˆ˜ ì¶”ê°€

#### 5. init_nutrition_integration.md
**ëŒ€ìƒ íŒŒì¼**: `logic_designer/__init__.py`

**ì£¼ìš” ë‚´ìš©**:
- í†µí•© ë¶„ì„ í•¨ìˆ˜ì— `product_id` ì¶”ê°€
- ì˜ì–‘ì„±ë¶„ ê²€ì¦ ê²°ê³¼ ì¡°íšŒ
- í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€

**í•µì‹¬ ê¸°ëŠ¥**:
- `analyze()` í•¨ìˆ˜ì— `product_id` ë° `use_nutrition_validation` ë§¤ê°œë³€ìˆ˜ ì¶”ê°€
- ì˜ì–‘ì„±ë¶„ ê²€ì¦ í†µí•©
- ê¸°ì¡´ API í˜¸í™˜ì„± ìœ ì§€

---

## 2ë‹¨ê³„: ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬ ê°€ì´ë“œ ì‘ì„±

### ì‘ì—… ë°°ê²½
ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­:
1. **ì˜ì–‘ì„±ë¶„ DBê°€ ì—†ì–´ë„ ì˜¤ë¥˜ ì—†ì´ ë™ì‘í•´ì•¼ í•¨**
2. **ë¦¬ë·°ê°€ ì ê±°ë‚˜ ì—†ì„ ê²½ìš°ì˜ ëŒ€ì²˜ ë°©ì•ˆ í•„ìš”**

### ìƒì„±ëœ íŒŒì¼

#### edge_cases_handling.md
**ëª©ì **: ì˜ˆì™¸ ìƒí™© ë° ì—£ì§€ ì¼€ì´ìŠ¤ ì²˜ë¦¬ ê°€ì´ë“œ

**ì£¼ìš” ë‚´ìš©**:

1. **í•µì‹¬ ì›ì¹™**
   - Graceful Degradation (ìš°ì•„í•œ ì„±ëŠ¥ ì €í•˜)
   - ì…ë ¥ ê²€ì¦ ê°•í™”

2. **ì˜ˆì™¸ ìƒí™©ë³„ ì²˜ë¦¬ ë°©ë²•**
   - ì˜ì–‘ì„±ë¶„ DB ê´€ë ¨ ì˜ˆì™¸
     - í…Œì´ë¸”ì´ ì—†ëŠ” ê²½ìš°
     - product_idê°€ Noneì´ê±°ë‚˜ ì˜ëª»ëœ ê²½ìš°
     - ë°ì´í„°ê°€ ë¶ˆì™„ì „í•œ ê²½ìš°
   - ë¦¬ë·° í…ìŠ¤íŠ¸ ê´€ë ¨ ì˜ˆì™¸
     - Noneì´ê±°ë‚˜ ë¹ˆ ë¬¸ìì—´
     - ë§¤ìš° ì§§ì€ ê²½ìš° (3-10ì)
     - íŠ¹ìˆ˜ ë¬¸ìë‚˜ ì¸ì½”ë”© ë¬¸ì œ
   - ì ìˆ˜ ê³„ì‚° ê´€ë ¨ ì˜ˆì™¸
     - ì˜ì–‘ì„±ë¶„ ì ìˆ˜ ê³„ì‚° ì‹¤íŒ¨ ì‹œ
   - AI ë¶„ì„ ê´€ë ¨ ì˜ˆì™¸
     - ë¦¬ë·°ê°€ ë„ˆë¬´ ì§§ì•„ì„œ ë¶„ì„ ë¶ˆê°€ëŠ¥í•œ ê²½ìš°

3. **í”„ë¡œì íŠ¸ ì „ì²´ ëŒ€ì²˜ ë°©ì•ˆ**
   - ë¦¬ë·° ë°ì´í„° ë¶€ì¡± ì‹œë‚˜ë¦¬ì˜¤
   - ì˜ì–‘ì„±ë¶„ DB ë¶€ì¬ ì‹œë‚˜ë¦¬ì˜¤
   - í†µí•© ëŒ€ì²˜ ì „ëµ

4. **êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸**
   - í•„ìˆ˜ êµ¬í˜„ í•­ëª©
   - ê¶Œì¥ êµ¬í˜„ í•­ëª©

5. **í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤**
   - ì˜ì–‘ì„±ë¶„ DB ì—†ìŒ
   - ë¦¬ë·° ì—†ìŒ
   - ë§¤ìš° ì§§ì€ ë¦¬ë·°
   - product_id ì—†ìŒ

---

## 3ë‹¨ê³„: ëª¨ë“  í”„ë¡¬í”„íŠ¸ì— ì˜ˆì™¸ ì²˜ë¦¬ ì¶”ê°€

### ìˆ˜ì • ì‚¬í•­

ëª¨ë“  í”„ë¡¬í”„íŠ¸ íŒŒì¼ì— ë‹¤ìŒ ë‚´ìš© ì¶”ê°€:

1. **ì•ˆì „í•œ DB ì¡°íšŒ í•¨ìˆ˜**
   ```python
   def _get_nutrition_info_safe(self, product_id: int) -> Optional[Dict]:
       """ì˜ì–‘ì„±ë¶„ ì •ë³´ ì¡°íšŒ (ì•ˆì „í•œ ë°©ì‹)"""
       try:
           # DB ì¡°íšŒ ë¡œì§
           return nutrition_info
       except Exception:
           return None  # ì˜¤ë¥˜ ì—†ì´ None ë°˜í™˜
   ```

2. **ì…ë ¥ ê²€ì¦ ê°•í™”**
   ```python
   # ë¦¬ë·°ê°€ Noneì´ê±°ë‚˜ ë¹ˆ ë¬¸ìì—´
   if not review_text:
       return {}
   
   # ë¦¬ë·°ê°€ ë„ˆë¬´ ì§§ì€ ê²½ìš°
   if len(review_text.strip()) < 3:
       return {}  # ìµœì†Œí•œì˜ ê²€ì‚¬ë§Œ ìˆ˜í–‰
   ```

3. **product_id ì„ íƒì  ì²˜ë¦¬**
   ```python
   # product_idê°€ ì—†ìœ¼ë©´ ì˜ì–‘ì„±ë¶„ ê²€ì¦ ìƒëµ
   if product_id:
       # ì˜ì–‘ì„±ë¶„ ê²€ì¦ ìˆ˜í–‰
   # ì—†ì–´ë„ ê¸°ì¡´ ê¸°ëŠ¥ì€ ì •ìƒ ë™ì‘
   ```

4. **ì˜¤ë¥˜ ë°œìƒ ì‹œ ê¸°ë³¸ê°’ ë°˜í™˜**
   - ëª¨ë“  try-except ë¸”ë¡ì—ì„œ ê¸°ë³¸ê°’ ë°˜í™˜
   - ì˜¤ë¥˜ ë¡œê¹…ì€ ì„ íƒì  (í”„ë¡œë•ì…˜ì—ì„œëŠ” ê¶Œì¥)

---

## 4ë‹¨ê³„: README ì—…ë°ì´íŠ¸

### ì¶”ê°€ëœ ë‚´ìš©

1. **ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬ ì„¹ì…˜ ì¶”ê°€**
   - ì˜ì–‘ì„±ë¶„ DBê°€ ì—†ì–´ë„ ì˜¤ë¥˜ ì—†ì´ ë™ì‘
   - ë¦¬ë·°ê°€ ì ê±°ë‚˜ ì—†ì„ ë•Œì˜ ì²˜ë¦¬
   - edge_cases_handling.md ì°¸ê³  ì•ˆë‚´

2. **íŒŒì¼ ëª©ë¡ì— edge_cases_handling.md ì¶”ê°€**
   - ì „ì²´ í”„ë¡œì íŠ¸ ëŒ€ìƒ
   - ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬ ê°€ì´ë“œ

---

## ìƒì„±ëœ íŒŒì¼ ëª©ë¡

### í”„ë¡¬í”„íŠ¸ íŒŒì¼ (7ê°œ)
1. `logic_designer/prompts/checklist_nutrition_integration.md` (283ì¤„)
2. `logic_designer/prompts/analyzer_nutrition_integration.md` (320ì¤„)
3. `logic_designer/prompts/trust_score_nutrition_integration.md` (356ì¤„)
4. `logic_designer/prompts/validator_nutrition_integration.md` (388ì¤„)
5. `logic_designer/prompts/init_nutrition_integration.md` (329ì¤„)
6. `logic_designer/prompts/edge_cases_handling.md` (529ì¤„) - ì‹ ê·œ
7. `logic_designer/prompts/README.md` (253ì¤„) - ì—…ë°ì´íŠ¸

**ì´ ë¼ì¸ ìˆ˜**: ì•½ 2,458ì¤„

---

## ì£¼ìš” ê°œì„  ì‚¬í•­

### 1. ì•ˆì „ì„± ê°•í™”
- âœ… ëª¨ë“  DB ì¡°íšŒ í•¨ìˆ˜ì— try-except ì¶”ê°€
- âœ… ì˜¤ë¥˜ ë°œìƒ ì‹œ ê¸°ë³¸ê°’ ë°˜í™˜ (ì˜¤ë¥˜ ì—†ì´)
- âœ… product_idê°€ Noneì´ì–´ë„ ì •ìƒ ë™ì‘

### 2. ì…ë ¥ ê²€ì¦ ê°•í™”
- âœ… ë¦¬ë·°ê°€ Noneì´ê±°ë‚˜ ë¹ˆ ë¬¸ìì—´ ì²˜ë¦¬
- âœ… ë¦¬ë·°ê°€ 3ì ë¯¸ë§Œì¼ ë•Œ ìµœì†Œí•œì˜ ê²€ì‚¬ë§Œ ìˆ˜í–‰
- âœ… ë¦¬ë·°ê°€ 10ì ë¯¸ë§Œì¼ ë•Œ ê¸°ë³¸ ë¶„ì„ë§Œ ì œê³µ

### 3. í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€
- âœ… ê¸°ì¡´ API ì‹œê·¸ë‹ˆì²˜ ìœ ì§€
- âœ… product_idëŠ” ì„ íƒì  ë§¤ê°œë³€ìˆ˜
- âœ… ì˜ì–‘ì„±ë¶„ DB ì—†ì–´ë„ ê¸°ì¡´ ê¸°ëŠ¥ ì •ìƒ ë™ì‘

### 4. ë¬¸ì„œí™” ê°•í™”
- âœ… ê° í”„ë¡¬í”„íŠ¸ì— êµ¬ì²´ì ì¸ ì½”ë“œ ì˜ˆì‹œ í¬í•¨
- âœ… í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ì œê³µ
- âœ… êµ¬í˜„ ìš”êµ¬ì‚¬í•­ ëª…ì‹œ
- âœ… ìš°ì„ ìˆœìœ„ ì œì‹œ

---

## ë‹¤ìŒ ë‹¨ê³„

### Phase 1: ê¸°ë°˜ êµ¬ì¡° êµ¬ì¶•
1. ì˜ì–‘ì„±ë¶„ DB ìŠ¤í‚¤ë§ˆ í™•ì¸/êµ¬ì¶•
2. ê³µí†µ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ êµ¬í˜„

### Phase 2: ê°œë³„ ëª¨ë“ˆ ê°œì„ 
1. trust_score.py (ìš°ì„ ìˆœìœ„: ë†’ìŒ)
2. checklist.py (ìš°ì„ ìˆœìœ„: ë†’ìŒ)
3. validator.py (ìš°ì„ ìˆœìœ„: ì¤‘ê°„)
4. analyzer.py (ìš°ì„ ìˆœìœ„: ì¤‘ê°„)
5. __init__.py (ìš°ì„ ìˆœìœ„: ë‚®ìŒ)

### Phase 3: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
1. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±
2. í†µí•© í…ŒìŠ¤íŠ¸ ìˆ˜í–‰
3. ì‹¤ì œ ë°ì´í„° ê²€ì¦

---

## ì°¸ê³  ìë£Œ

- ì‹í’ˆì˜ì•½í’ˆì•ˆì „ì²˜ ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ ì •ë³´: https://www.foodsafetykorea.go.kr/
- ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ ê³µì „
- GitHub ì €ì¥ì†Œ: https://github.com/tturupapa-stack/dev2/
- Supabase í”„ë¡œì íŠ¸: https://supabase.com/dashboard/project/bvowxbpqtfpkkxkzsumf

---

## ë°°ìš´ ì 

1. **Graceful Degradationì˜ ì¤‘ìš”ì„±**
   - ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ ê¸°ì¡´ ê¸°ëŠ¥ì€ í•­ìƒ ìœ ì§€ë˜ì–´ì•¼ í•¨
   - ì˜¤ë¥˜ ë°œìƒ ì‹œ ê¸°ë³¸ê°’ ë°˜í™˜ìœ¼ë¡œ ì‚¬ìš©ì ê²½í—˜ ë³´í˜¸

2. **ì…ë ¥ ê²€ì¦ì˜ í•„ìš”ì„±**
   - ëª¨ë“  ì™¸ë¶€ ì…ë ¥ì€ ê²€ì¦ í•„ìš”
   - ì˜ˆìƒì¹˜ ëª»í•œ ë°ì´í„° í˜•ì‹ì— ëŒ€ë¹„

3. **ë¬¸ì„œí™”ì˜ ê°€ì¹˜**
   - êµ¬ì²´ì ì¸ ì½”ë“œ ì˜ˆì‹œê°€ êµ¬í˜„ì— ë„ì›€
   - í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ë¡œ ê²€ì¦ ê°€ëŠ¥

---

## ì™„ë£Œ ìƒíƒœ

- âœ… ì˜ì–‘ì„±ë¶„ DB í†µí•© í”„ë¡¬í”„íŠ¸ ì‘ì„± ì™„ë£Œ (5ê°œ íŒŒì¼)
- âœ… ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬ ê°€ì´ë“œ ì‘ì„± ì™„ë£Œ
- âœ… ëª¨ë“  í”„ë¡¬í”„íŠ¸ì— ì˜ˆì™¸ ì²˜ë¦¬ ì¶”ê°€ ì™„ë£Œ
- âœ… README ì—…ë°ì´íŠ¸ ì™„ë£Œ
- âœ… ê°œë°œì¼ì§€ ì‘ì„± ì™„ë£Œ

---

**ì‘ì—… ì‹œê°„**: ì•½ 2ì‹œê°„
**ìƒì„±ëœ íŒŒì¼**: 7ê°œ
**ì´ ë¼ì¸ ìˆ˜**: ì•½ 2,458ì¤„
