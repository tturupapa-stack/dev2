# 리뷰 DB 활용 개선 제안서

**작성일**: 2026-01-14  
**작성자**: Red Team UI/UX 개발자  
**목적**: Supabase reviews 테이블을 활용한 리뷰 분석 시스템 고도화

---

## 📋 현재 시스템 분석

### 데이터베이스 구조
- **products 테이블**: 30개 제품 (brand, title, price, rating_avg, rating_count)
- **reviews 테이블**: 제품별 리뷰 (author, rating, title, body, language, review_date, helpful_count)

### 현재 활용 기능
- ✅ 8단계 리뷰 팩트체크 시스템
- ✅ 제품 비교 분석 (다차원 차트)
- ✅ 필터링 (가격, 평점, 리뷰 수)
- ✅ 통계 대시보드

---

## 💡 개선 아이디어 (우선순위별)

### 🔥 최우선 개선 (즉시 적용 가능)

#### 1. 리뷰 텍스트 키워드 분석
**목적**: 사용자가 리뷰에서 자주 언급하는 키워드를 시각화

**구현 방법**:
```python
# reviews 테이블의 body 필드 분석
- 긍정 키워드 추출: "효과", "좋아요", "추천", "만족"
- 부정 키워드 추출: "부작용", "실망", "별로", "후회"
- 제품 특성 키워드: "가격", "배송", "포장", "성분"
```

**UI 표시**:
- 워드클라우드 차트
- 키워드 빈도 바 차트
- 긍정/부정 비율 게이지

**활용 DB 필드**:
- `reviews.body` (리뷰 본문)
- `reviews.rating` (평점과 키워드 상관관계 분석)

---

#### 2. 시간대별 리뷰 트렌드 분석
**목적**: 제품 품질이 시간에 따라 어떻게 변했는지 확인

**구현 방법**:
```python
# reviews.review_date를 기준으로 월별/분기별 평점 추이 분석
- 최근 3개월 vs 6개월 이전 평점 비교
- 평점 하락/상승 알림 시스템
- "초기 좋았으나 최근 나빠짐" 패턴 탐지
```

**UI 표시**:
- 시계열 라인 차트 (월별 평균 평점)
- 트렌드 아이콘 (📈 상승, 📉 하락, ➡️ 안정)
- 경고 배지: "⚠️ 최근 3개월 평점 하락"

**활용 DB 필드**:
- `reviews.review_date`
- `reviews.rating`
- `reviews.body` (시기별 불만 키워드 변화)

---

#### 3. 리뷰어 신뢰도 점수 시스템
**목적**: 리뷰 작성자의 신뢰도를 평가하여 가짜 리뷰 탐지

**구현 방법**:
```python
# reviews.author 기준 분석
신뢰도 점수 = (
    + 리뷰 개수 (다양한 제품 리뷰 작성 → 신뢰 ↑)
    + helpful_count (유용함 투표 많음 → 신뢰 ↑)
    + 리뷰 길이 (50자 이상 → 신뢰 ↑)
    - 동일 날짜 다수 리뷰 (스팸 의심 → 신뢰 ↓)
    - 모두 5점 리뷰 (광고 의심 → 신뢰 ↓)
)
```

**UI 표시**:
- 리뷰어 배지: 🏆 신뢰 리뷰어, ⭐ 베테랑, ⚠️ 주의 필요
- 제품별 "신뢰 리뷰 비율" 표시
- 필터: "신뢰 리뷰만 보기" 옵션

**활용 DB 필드**:
- `reviews.author`
- `reviews.helpful_count`
- `reviews.rating`
- `reviews.body` (길이)
- `reviews.review_date`

---

#### 4. 언어별 리뷰 비교 분석
**목적**: 한국어 vs 영어 리뷰의 평가 차이 확인

**구현 방법**:
```python
# reviews.language 기준 분석
- 언어별 평균 평점 비교
- 언어별 주요 키워드 차이
- 문화적 차이 탐지 (한국: 배송, 포장 중시 vs 미국: 효능 중시)
```

**UI 표시**:
- 언어별 평점 비교 바 차트
- 탭: "🇰🇷 한국어 리뷰" | "🇺🇸 영어 리뷰" | "🌏 전체"
- 언어별 키워드 워드클라우드 비교

**활용 DB 필드**:
- `reviews.language`
- `reviews.rating`
- `reviews.body`

---

### ⚡ 중요 개선 (2주 내 적용)

#### 5. 리뷰 유용성 예측 AI
**목적**: helpful_count를 학습하여 유용한 리뷰를 상단에 노출

**구현 방법**:
```python
# 머신러닝 모델 학습
특징(Feature):
- 리뷰 길이 (body 문자 수)
- 평점 (rating)
- 작성 시기 (review_date의 최신성)
- 키워드 포함 여부 ("효과", "부작용", "사용법" 등)

목표(Target):
- helpful_count (높을수록 유용한 리뷰)
```

**UI 표시**:
- 리뷰 정렬: "유용한 순" (AI 예측 점수)
- 추천 배지: "💡 가장 유용한 리뷰"
- 사용자 피드백: "이 리뷰가 도움이 되셨나요?" 버튼

**활용 DB 필드**:
- `reviews.helpful_count`
- `reviews.body`
- `reviews.rating`
- `reviews.review_date`

---

#### 6. 제품 간 리뷰 유사도 분석
**목적**: 비슷한 제품의 리뷰를 비교하여 차별점 발견

**구현 방법**:
```python
# TF-IDF + 코사인 유사도
1. 같은 카테고리 제품들의 리뷰 body를 벡터화
2. 유사도가 높은 제품 찾기
3. 차별적 키워드 추출 (A 제품만 언급되는 단어)
```

**UI 표시**:
- "이 제품과 유사한 제품" 추천
- 차별점 하이라이트: "이 제품만의 장점"
- 비교표: "A는 '가성비', B는 '프리미엄' 언급 많음"

**활용 DB 필드**:
- `reviews.body`
- `products.category`
- `products.brand`

---

#### 7. 부정적 리뷰 자동 알림 시스템
**목적**: 제품의 품질 문제를 조기 발견

**구현 방법**:
```python
# 실시간 모니터링
조건:
- 최근 7일 내 1점/2점 리뷰 3개 이상
- "부작용", "환불", "불량" 키워드 급증
- 평균 평점 0.5점 이상 급락
```

**UI 표시**:
- 🚨 경고 배너: "최근 부정적 리뷰 증가 주의"
- 알림 페이지: "주의 필요 제품 목록"
- 자동 필터링: "문제 제품 제외" 옵션

**활용 DB 필드**:
- `reviews.rating`
- `reviews.review_date`
- `reviews.body`

---

#### 8. 리뷰 검증 배지 시스템
**목적**: 신뢰할 수 있는 리뷰를 한눈에 구분

**구현 방법**:
```python
배지 종류:
✅ 인증 구매: 실제 구매 확인 (현재 verified 필드)
🏆 베스트 리뷰: helpful_count 상위 10%
📝 상세 리뷰: body 길이 200자 이상
⏰ 장기 사용: "3개월", "6개월" 키워드 포함
🔁 재구매: "재구매", "또 샀어요" 키워드
```

**UI 표시**:
- 리뷰 목록에 배지 아이콘 표시
- 필터: "배지별 리뷰 보기"
- 통계: "배지 획득 리뷰 비율"

**활용 DB 필드**:
- `reviews.helpful_count`
- `reviews.body`
- 새 필드 제안: `reviews.verified_purchase` (boolean)
- 새 필드 제안: `reviews.badges` (json array)

---

### 🎯 장기 개선 (1개월 이상)

#### 9. Claude AI 기반 리뷰 요약
**목적**: 수백 개 리뷰를 한눈에 파악

**구현 방법**:
```python
# Anthropic Claude API 사용
1. 제품별 리뷰 body를 모두 수집
2. Claude에게 "이 제품의 리뷰를 3줄로 요약해줘" 요청
3. 장점/단점/주의사항 구조화된 요약
```

**UI 표시**:
- 📊 AI 요약 카드 (상단 고정)
- "👍 주요 장점", "👎 주요 단점", "⚠️ 주의사항"
- "자세히 보기" 버튼으로 전체 리뷰 확인

**활용 DB 필드**:
- `reviews.body`
- `reviews.rating`
- `reviews.title`

**필요 자원**:
- Anthropic API Key (이미 secrets.toml에 있음)

---

#### 10. 리뷰 작성자 프로필 시스템
**목적**: 리뷰어의 선호도와 신뢰도를 시각화

**구현 방법**:
```python
# reviews.author 기준 프로필 생성
프로필 정보:
- 총 리뷰 수
- 평균 평점 (너무 높거나 낮으면 편향 의심)
- 주요 리뷰 카테고리
- 받은 helpful_count 합계
- 신뢰도 점수 (위 3번 아이디어)
```

**UI 표시**:
- 리뷰어 이름 클릭 시 프로필 팝업
- 프로필 카드: 아바타, 통계, 배지
- "이 리뷰어의 다른 리뷰 보기"

**활용 DB 필드**:
- `reviews.author`
- 모든 reviews 필드
- 새 테이블 제안: `reviewer_profiles`

---

## 🛠️ 구현 우선순위

### Phase 1: 즉시 적용 (이번 주)
1. ✅ **시간대별 리뷰 트렌드 분석** (가장 쉬움, 효과 높음)
2. ✅ **언어별 리뷰 비교** (language 필드만 활용)
3. ✅ **리뷰 검증 배지 시스템** (UI 간단, 신뢰도 향상)

### Phase 2: 2주 내 적용
4. ⚡ **리뷰 텍스트 키워드 분석** (NLP 기초)
5. ⚡ **리뷰어 신뢰도 점수** (알고리즘 구현)
6. ⚡ **부정적 리뷰 알림** (필터링 + 통계)

### Phase 3: 1개월 내 적용
7. 🎯 **리뷰 유용성 예측 AI** (ML 모델 필요)
8. 🎯 **제품 간 유사도 분석** (TF-IDF)
9. 🎯 **Claude AI 리뷰 요약** (API 연동)

### Phase 4: 장기 로드맵
10. 🔮 **리뷰어 프로필 시스템** (새 테이블 설계)

---

## 📊 예상 효과

| 개선사항 | 사용자 만족도 | 개발 난이도 | 차별화 |
|---------|--------------|------------|--------|
| 시간대별 트렌드 | ⭐⭐⭐⭐⭐ | 쉬움 | 높음 |
| 언어별 비교 | ⭐⭐⭐⭐ | 쉬움 | 중간 |
| 리뷰 배지 | ⭐⭐⭐⭐ | 쉬움 | 높음 |
| 키워드 분석 | ⭐⭐⭐⭐⭐ | 중간 | 매우 높음 |
| 신뢰도 점수 | ⭐⭐⭐⭐⭐ | 중간 | 매우 높음 |
| AI 요약 | ⭐⭐⭐⭐⭐ | 어려움 | 최고 |

---

## 🗃️ 필요한 DB 스키마 확장

```sql
-- 리뷰어 프로필 테이블 (선택)
CREATE TABLE reviewer_profiles (
  id BIGSERIAL PRIMARY KEY,
  author TEXT UNIQUE NOT NULL,
  total_reviews INT DEFAULT 0,
  avg_rating NUMERIC,
  total_helpful_count INT DEFAULT 0,
  trust_score NUMERIC,  -- 신뢰도 점수 (0-100)
  badges JSONB,  -- ["verified", "expert", "helpful"]
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- 리뷰 배지 정보 추가 (기존 reviews 테이블 확장)
ALTER TABLE reviews 
  ADD COLUMN badges JSONB,  -- ["verified_purchase", "best_review", "detailed"]
  ADD COLUMN trust_score NUMERIC,  -- 개별 리뷰 신뢰도
  ADD COLUMN ai_sentiment TEXT,  -- "positive", "negative", "neutral"
  ADD COLUMN ai_keywords JSONB;  -- ["효과", "가격", "배송"]

-- 키워드 분석 캐시 테이블 (성능 최적화)
CREATE TABLE review_keywords (
  id BIGSERIAL PRIMARY KEY,
  product_id BIGINT REFERENCES products(id),
  keyword TEXT,
  frequency INT,
  sentiment TEXT,  -- "positive", "negative", "neutral"
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

---

## 🚀 첫 번째 단계 구현 예시

### 1. 시간대별 리뷰 트렌드 (코드 예시)

```python
# supabase_data.py에 추가
def get_review_trend_by_time(product_id: str, months: int = 6):
    """제품의 월별 평점 추이 조회"""
    reviews = _fetch_from_supabase(
        'reviews', 
        f'select=review_date,rating&product_id=eq.{product_id}&order=review_date.asc'
    )
    
    # 월별 그룹화
    import pandas as pd
    df = pd.DataFrame(reviews)
    df['review_date'] = pd.to_datetime(df['review_date'])
    df['month'] = df['review_date'].dt.to_period('M')
    
    monthly_avg = df.groupby('month')['rating'].agg(['mean', 'count']).reset_index()
    return monthly_avg.to_dict('records')

# app.py에서 사용
trend_data = get_review_trend_by_time(main_product_id)
# Plotly로 시계열 차트 생성
```

### 2. 언어별 비교 (코드 예시)

```python
# supabase_data.py에 추가
def get_reviews_by_language_stats(product_id: str):
    """언어별 평균 평점 및 리뷰 수"""
    reviews = _fetch_from_supabase(
        'reviews',
        f'select=language,rating&product_id=eq.{product_id}'
    )
    
    stats = {}
    for lang in ['ko', 'en', 'ja', 'es']:  # 주요 언어
        lang_reviews = [r for r in reviews if r.get('language') == lang]
        if lang_reviews:
            stats[lang] = {
                'count': len(lang_reviews),
                'avg_rating': sum(r['rating'] for r in lang_reviews) / len(lang_reviews)
            }
    return stats

# app.py에서 사용
lang_stats = get_reviews_by_language_stats(main_product_id)
# 바 차트로 시각화
```

---

## 📝 결론

Supabase의 `reviews` 테이블은 다양한 고급 분석이 가능한 풍부한 데이터를 제공합니다. 특히:

1. **즉시 적용 가능**: `review_date`, `language`, `helpful_count` 필드는 추가 처리 없이 바로 활용
2. **텍스트 분석 가능**: `body` 필드로 키워드, 감성, 유사도 분석 가능
3. **신뢰도 평가**: `author`, `rating`, `helpful_count` 조합으로 가짜 리뷰 탐지
4. **시계열 분석**: `review_date`로 제품 품질 변화 추적

**추천 시작점**: Phase 1의 3가지 (시간대별 트렌드, 언어별 비교, 배지 시스템)을 먼저 구현하면 즉각적인 사용자 만족도 향상을 기대할 수 있습니다.

---

**다음 단계**: 어떤 기능부터 구현할지 결정해주시면 상세 설계 및 코드 작성을 진행하겠습니다! 🚀
